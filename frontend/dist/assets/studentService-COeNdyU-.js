var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,d=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&s(e,n,t[n]);if(r)for(var n of r(t))o.call(t,n)&&s(e,n,t[n]);return e},u=(e,r)=>t(e,n(r)),i=(e,t,n)=>new Promise(((r,a)=>{var o=e=>{try{d(n.next(e))}catch(t){a(t)}},s=e=>{try{d(n.throw(e))}catch(t){a(t)}},d=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);d((n=n.apply(e,t)).next())}));import{c as l,T as c}from"./index-B9AZMt1L.js";const p={getAllStudents:()=>i(void 0,null,(function*(){try{if(!(localStorage.getItem("token")||sessionStorage.getItem("token")))return c.error("Authentication required. Please log in again."),{students:[]};return(yield l.get("/admin/students/all")).data}catch(e){return e.response?401===e.response.status?c.error("Authentication required. Please log in again."):403===e.response.status?c.error("You do not have permission to access student data."):c.error("Failed to load students. Please try again later."):c.error("Network error. Please check your connection."),{students:[]}}})),getStudents:(...e)=>i(void 0,[...e],(function*(e={}){try{if(!(localStorage.getItem("token")||sessionStorage.getItem("token")))return c.error("Authentication required. Please log in again."),{students:[]};return(yield l.get("/admin/students",{params:e})).data}catch(t){return t.response?401===t.response.status?c.error("Authentication required. Please log in again."):403===t.response.status?c.error("You do not have permission to access student data."):c.error("Failed to load students. Please try again later."):c.error("Network error. Please check your connection."),{students:[]}}})),getStudentsByIndexNumber:e=>i(void 0,null,(function*(){try{const t={indexNumber:e.trim()};return(yield l.get("/admin/students",{params:t})).data}catch(t){throw t}})),registerStudent:e=>i(void 0,null,(function*(){var t,n,r,a,o;try{const a=u(d({},e),{indexNumber:null==(t=e.indexNumber)?void 0:t.toUpperCase(),parent_telephone:null==(n=e.parent_telephone)?void 0:n.trim()}),o=yield l.post("/admin/students",a);return c.success("Student registered successfully"),(null==(r=o.data)?void 0:r.qrCode)?u(d({},o.data),{qrCodeUrl:o.data.qrCode}):o.data}catch(s){throw c.error((null==(o=null==(a=s.response)?void 0:a.data)?void 0:o.message)||"Failed to register student"),s}})),updateStudent:(e,t)=>i(void 0,null,(function*(){var n,r;try{const n=d({},t);t.indexNumber&&(n.indexNumber=t.indexNumber.toUpperCase()),t.parent_telephone&&(n.parent_telephone=t.parent_telephone.trim());const r=yield l.put(`/admin/students/${e}`,n);return c.success("Student updated successfully"),r.data}catch(a){throw c.error((null==(r=null==(n=a.response)?void 0:n.data)?void 0:r.message)||"Failed to update student"),a}})),deleteStudent:e=>i(void 0,null,(function*(){var t,n;try{const t=yield l.delete(`/admin/students/${e}`);return c.success("Student deleted successfully"),t.data}catch(r){throw c.error((null==(n=null==(t=r.response)?void 0:t.data)?void 0:n.message)||"Failed to delete student"),r}})),getStudentProfile:e=>i(void 0,null,(function*(){try{return(yield l.get(`/students/profile/${e}`)).data}catch(t){throw t}})),updateStudentProfile:(e,t)=>i(void 0,null,(function*(){var n,r;try{const n=yield l.patch(`/students/profile/${e}`,t);return c.success("Student profile updated successfully"),n.data}catch(a){throw c.error((null==(r=null==(n=a.response)?void 0:n.data)?void 0:r.message)||"Failed to update student profile"),a}})),generateStudentQRCode:e=>i(void 0,null,(function*(){try{return(yield l.get(`/admin/students/${e}/qr-code`,{responseType:"blob"})).data}catch(t){throw t}})),getStudentQRByIndex:e=>i(void 0,null,(function*(){try{if(!e)throw new Error("Index number is required");return(yield l.get(`/admin/students/qr-code/${e}`,{responseType:"blob"})).data}catch(t){throw t}})),getStudentAttendanceHistory:(e,...t)=>i(void 0,[e,...t],(function*(e,t={}){var n,r;try{if(!e)return c.error("Invalid student ID"),{student:null,attendanceHistory:[],stats:{totalCount:0,presentCount:0,absentCount:0,leftCount:0,attendancePercentage:0},totalRecords:0};const o=new URLSearchParams;t.startDate&&o.append("startDate",t.startDate),t.endDate&&o.append("endDate",t.endDate),t.limit&&o.append("limit",t.limit),t.offset&&o.append("offset",t.offset),t.sortBy&&o.append("sortBy",t.sortBy),t.sortOrder&&o.append("sortOrder",t.sortOrder);try{const t=yield l.get(`/attendance/student/${e}/history?${o.toString()}`);if(null==(n=t.data)?void 0:n.success){const e=t.data.data||{};return{student:e.student||null,attendanceHistory:e.attendanceHistory||[],stats:e.stats||{totalCount:0,presentCount:0,absentCount:0,leftCount:0,attendancePercentage:0},totalRecords:e.totalRecords||0}}}catch(a){}const s=yield l.get(`/students/attendance-history/${e}?${o.toString()}`),d=(null==(r=s.data)?void 0:r.data)||s.data;return{student:(null==d?void 0:d.student)||null,attendanceHistory:(null==d?void 0:d.attendanceHistory)||[],stats:(null==d?void 0:d.stats)||{totalCount:0,presentCount:0,absentCount:0,leftCount:0,attendancePercentage:0},totalRecords:(null==d?void 0:d.totalRecords)||0}}catch(o){return c.error("Failed to load attendance history"),{student:null,attendanceHistory:[],stats:{totalCount:0,presentCount:0,absentCount:0,leftCount:0,attendancePercentage:0},totalRecords:0}}})),clearAttendanceHistory:e=>i(void 0,null,(function*(){try{if(!e)return c.error("Invalid student ID"),{success:!1,message:"Invalid student ID"};if(!window.confirm("Are you sure you want to clear all attendance history for this student? This action cannot be undone."))return{cancelled:!0};const t=yield l.delete(`/attendance/student/${e}/clear`);return c.success("Successfully cleared attendance history"),t.data}catch(t){return c.error("Failed to clear attendance history"),{success:!1,error:t.message}}})),deleteAttendanceRecord:(e,t)=>i(void 0,null,(function*(){var n,r;try{if(!e||!t)return c.error("Invalid parameters"),{success:!1,message:"Invalid parameters"};const n=localStorage.getItem("token")||sessionStorage.getItem("token");if(!n)return c.error("You must be logged in to delete attendance records"),setTimeout((()=>{window.location.href="/login"}),1e3),{success:!1,message:"Authentication required"};if(!window.confirm("Are you sure you want to delete this attendance record? This action cannot be undone."))return{cancelled:!0};return{success:!0,data:(yield l.delete(`/attendance/student/${e}/record/${t}`,{headers:{Authorization:`Bearer ${n}`}})).data}}catch(a){let e="Failed to delete attendance record";return 401===(null==(n=a.response)?void 0:n.status)?e="Authentication required to delete attendance records":403===(null==(r=a.response)?void 0:r.status)&&(e="You donâ€™t have permission to delete attendance records"),c.error(e),{success:!1,message:e}}})),getDashboardStats:()=>i(void 0,null,(function*(){try{return(yield l.get("/students/dashboard-stats")).data}catch(e){throw e}})),searchStudents:(e,...t)=>i(void 0,[e,...t],(function*(e,t={}){try{const n=d({search:e},t);return(yield l.get("/admin/students/search",{params:n})).data}catch(n){throw n}}))};export{p as s};
